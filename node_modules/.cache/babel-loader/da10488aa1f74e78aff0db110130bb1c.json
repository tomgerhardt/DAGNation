{"ast":null,"code":"import { Contract } from '@ethersproject/contracts';\nconst ABI = ['function aggregate(tuple(address target, bytes callData)[] calls) view returns (uint256 blockNumber, bytes[] returnData)'];\n/**\n * @public\n */\n\nexport async function multicall(provider, address, blockNumber, requests) {\n  var _a;\n\n  if (requests.length === 0) {\n    return {};\n  }\n\n  const contract = new Contract(address, ABI, provider);\n  const [, results] = await contract.aggregate(requests.map(_ref => {\n    let {\n      address,\n      data\n    } = _ref;\n    return [address, data];\n  }), {\n    blockTag: blockNumber\n  });\n  const state = {};\n\n  for (let i = 0; i < requests.length; i++) {\n    const {\n      address,\n      data\n    } = requests[i];\n    const result = results[i];\n    const stateForAddress = (_a = state[address]) !== null && _a !== void 0 ? _a : {};\n    stateForAddress[data] = {\n      value: result,\n      success: true\n    };\n    state[address] = stateForAddress;\n  }\n\n  return state;\n}","map":{"version":3,"mappings":"AACA,SAASA,QAAT,QAAyB,0BAAzB;AAKA,MAAMC,GAAG,GAAG,CACV,0HADU,CAAZ;AAIA;;;;AAGA,OAAO,eAAeC,SAAf,CACLC,QADK,EAELC,OAFK,EAGLC,WAHK,EAILC,QAJK,EAIc;;;AAEnB,MAAIA,QAAQ,CAACC,MAAT,KAAoB,CAAxB,EAA2B;AACzB,WAAO,EAAP;AACD;;AACD,QAAMC,QAAQ,GAAG,IAAIR,QAAJ,CAAaI,OAAb,EAAsBH,GAAtB,EAA2BE,QAA3B,CAAjB;AACA,QAAM,GAAGM,OAAH,IAAqC,MAAMD,QAAQ,CAACE,SAAT,CAC/CJ,QAAQ,CAACK,GAAT,CAAa;AAAA,QAAC;AAAEP,aAAF;AAAWQ;AAAX,KAAD;AAAA,WAAuB,CAACR,OAAD,EAAUQ,IAAV,CAAvB;AAAA,GAAb,CAD+C,EAE/C;AAAEC,YAAQ,EAAER;AAAZ,GAF+C,CAAjD;AAIA,QAAMS,KAAK,GAAe,EAA1B;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,QAAQ,CAACC,MAA7B,EAAqCQ,CAAC,EAAtC,EAA0C;AACxC,UAAM;AAAEX,aAAF;AAAWQ;AAAX,QAAoBN,QAAQ,CAACS,CAAD,CAAlC;AACA,UAAMC,MAAM,GAAGP,OAAO,CAACM,CAAD,CAAtB;AACA,UAAME,eAAe,GAAG,WAAK,CAACb,OAAD,CAAL,MAAc,IAAd,IAAcc,aAAd,GAAcA,EAAd,GAAkB,EAA1C;AACAD,mBAAe,CAACL,IAAD,CAAf,GAAwB;AAAEO,WAAK,EAAEH,MAAT;AAAiBI,aAAO,EAAE;AAA1B,KAAxB;AACAN,SAAK,CAACV,OAAD,CAAL,GAAiBa,eAAjB;AACD;;AACD,SAAOH,KAAP;AACD","names":["Contract","ABI","multicall","provider","address","blockNumber","requests","length","contract","results","aggregate","map","data","blockTag","state","i","result","stateForAddress","_a","value","success"],"sources":["../../../../../../src/providers/chainState/common/multicall.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}